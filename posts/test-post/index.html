<!DOCTYPE html>
<html lang="zh-cn"><head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='å¸¸è§DOMä»¥åŠAPIæ€»ç»“'><title>å¸¸è§DOMä»¥åŠAPIæ€»ç»“</title>
    
    <link rel='canonical' href='https://808Mak1r.github.io/posts/test-post/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='å¸¸è§DOMä»¥åŠAPIæ€»ç»“'>
<meta property='og:description' content='å¸¸è§DOMä»¥åŠAPIæ€»ç»“'>
<meta property='og:url' content='https://808Mak1r.github.io/posts/test-post/'>
<meta property='og:site_name' content='808Mak1r'>
<meta property='og:type' content='article'><meta property='article:section' content='Posts' /><meta property='article:tag' content='å‰ç«¯' /><meta property='article:published_time' content='2019-08-20T17:57:12&#43;08:00'/><meta property='article:modified_time' content='2019-08-20T17:57:12&#43;08:00'/>
<meta name="twitter:title" content="å¸¸è§DOMä»¥åŠAPIæ€»ç»“">
<meta name="twitter:description" content="å¸¸è§DOMä»¥åŠAPIæ€»ç»“"></head><body class="article-page keep-sidebar">
        <div class="container flex on-phone--column align-items--flex-start extended ">
            <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            <figure class="site-avatar">
                

                
                    
                    <img src="/img/avatar_huc27c05c82a2ac95e859c24d4aef51b1b_27184_300x300_resize_box_2.png" width="300"
                        height="300" class="site-logo" loading="lazy" alt="Avatar">
                

                <span class="emoji">ğŸ¥</span>
            </figure>
        
        <h1 class="site-name"><a href="https://808Mak1r.github.io">808Mak1r</a></h1>
        <h2 class="site-description">ä¸“æ³¨äºä¸‹æ°´é“ç–é€šã€‚</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
    </ol>
</aside>
            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            
                <a href="/categories/%E5%8D%9A%E5%AE%A2/">åšå®¢</a>
            
        
    </header>
    

    <h2 class="article-title">
        <a href="/posts/test-post/">å¸¸è§DOMä»¥åŠAPIæ€»ç»“</a>
    </h2>

    
    <h3 class="article-subtitle">
        å¸¸è§DOMä»¥åŠAPIæ€»ç»“
    </h3>
    <footer class="article-time">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <time class="article-time--published">Apr 12, 2019</time>
    </footer></div>
</header>

    <section class="article-content">
    <h2 id="å»æ‰è™šæ‹Ÿä¸¤ä¸ªå­—å…ˆäº†è§£ä¸‹ä»€ä¹ˆæ˜¯dom">å»æ‰è™šæ‹Ÿä¸¤ä¸ªå­—ï¼Œå…ˆäº†è§£ä¸‹ä»€ä¹ˆæ˜¯DOMï¼Ÿ</h2>
<blockquote>
<p>åœ¨åŸç”ŸJSä¸­æœ‰DOMæ“ä½œï¼Œå°±æ˜¯ä½¿ç”¨æµè§ˆå™¨æä¾›çš„ä¸€äº›APIï¼Œé€‰ä¸­ä¸€ä¸ªå…ƒç´ å¯¹å®ƒè¿›è¡Œæ“ä½œï¼Œæ¯”å¦‚è¯´ï¼šå¢åŠ ä¸€ä¸ªå±æ€§ã€å¢åŠ ä¸€ä¸ªå­©å­ã€ä¿®æ”¹å®ƒé‡Œé¢çš„å†…å®¹ã€æ”¹å˜å®ƒçš„ä½ç½®ï¼Œç›´æ¥å¯¹DOMæ“ä½œã€‚è¿™ä¸ªDOMå®é™…ä¸Šå¯¹åº”çš„å°±æ˜¯æµè§ˆå™¨é‡Œé¢ä½ æ‰€èƒ½çœ‹çš„è§çš„å¯¹åº”çš„æŸä¸ªå…ƒç´ ã€‚</p>
</blockquote>
<h2 id="é‚£ä»€ä¹ˆæ˜¯è™šæ‹Ÿdom">é‚£ä»€ä¹ˆæ˜¯è™šæ‹ŸDOM</h2>
<blockquote>
<p>å‡è®¾æˆ‘ä»¬è¦æ“ä½œä¸€ä¸ªæ•°æ®çš„æŠ¥è¡¨ï¼Œè¿™ä¸ªæŠ¥è¡¨å¤§æ¦‚æœ‰å‡ ç™¾æ¡æ•°æ®ï¼Œæˆ‘ä»¬è¦å¯¹è¿™ä¸ªæŠ¥è¡¨è¿›è¡Œä¸€ä¸ªæ’åºçš„æ“ä½œ</p>
</blockquote>
<p>æˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªè¡¨æ ¼ï¼Œè¿™é‡Œé¢å¤§æ¦‚æœ‰100å¤šé¡¹</p>
<table>
<thead>
<tr>
<th>å§“å</th>
<th>å¹´çºª</th>
<th>åˆ†æ•°</th>
<th>ç­‰ç­‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>å°çº¢</td>
<td>12</td>
<td>44</td>
<td></td>
</tr>
<tr>
<td>å°èŠ±</td>
<td>13</td>
<td>78</td>
<td></td>
</tr>
</tbody>
</table>
<ol>
<li>
<p>å½“æˆ‘å»ç‚¹å¹´çºªçš„æ—¶å€™ï¼Œå¸Œæœ›å¹´çºªé‡Œçš„æ‰€æœ‰DOMå…ƒç´ å¯ä»¥æŒ‰ç…§å¹´çºªå»æ’åºï¼Œå½“æˆ‘ç‚¹æ–°å¢çš„æ—¶å€™ä¼šåœ¨è¡¨æ ¼ä¸‹é¢å†æ–°å¢ä¸€è¡Œæ•°æ®ï¼Œå½“æˆ‘ç‚¹å‡»å§“åçš„æ—¶å€™æ‰€æœ‰DOMæŒ‰ç…§å§“åå»åšä¸€ä¸ªæ’åºï¼Œæˆ‘ä»¬å¯ä»¥æƒ³ä¸‹ç”¨åŸç”ŸJSæ€ä¹ˆå»åšæ’åºï¼Œç”¨JSå»å¯¹DOMç»“æ„å»æ’åºï¼Œæ“ä½œèµ·æ¥å¾ˆéš¾å®ç°ï¼Œä¹Ÿå¾ˆéº»çƒ¦ã€‚</p>
</li>
<li>
<p>åæ¥æˆ‘ä»¬æœ‰äº†MVVMæ¡†æ¶å¯ä»¥å¯¹æ•°æ®æ’åºï¼Œæ•°æ®å¯¹åº”åˆ°é¡µé¢ä¸Šçš„DOMç»“æ„ï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹æ•°æ®æ’åºï¼Œé‚£é‡Œé¢çš„DOMç»“æ„è‡ªç„¶å°±æ’åºäº†ã€‚</p>
</li>
<li>
<p>æˆ‘ä»¬è‡ªå·±å®ç°ä¸€ä¸ªæ¡†æ¶ï¼Œå‡è®¾æ•°æ®å˜äº†ï¼Œé‚£æˆ‘ä»¬çš„DOMç»“æ„ä¹Ÿå°±å˜äº†ï¼Œéš¾é“æˆ‘ä»¬éœ€è¦æŠŠæ•°æ®é‡æ–°æ¸²æŸ“ä¸€æ¬¡ï¼Œå¦‚æœç”¨æˆ·é¢‘ç¹å¤§é‡æ”¹åŠ¨æ•°æ®ï¼ŒDOMä¹Ÿä¼šé¢‘ç¹æ”¹åŠ¨ï¼Œå°±ä¼šé€ æˆå¡é¡¿ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å»åšä¸€äº›ä¼˜åŒ–ï¼Œæ€ä¹ˆå»åšä¼˜åŒ–å‘¢ï¼Ÿ</p>
</li>
<li>
<p>é‚£æˆ‘ä»¬å¯ä»¥åƒè®¡ç®—æœºå†…å­˜é‚£æ ·ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±è®¾å®šä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ç»“æ„ï¼Œå®ƒæ˜¯å¯¹çœŸå®çš„DOMç»“æ„æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå¯¹è™šæ‹Ÿçš„æ•°æ®ç»“æ„è¿›è¡Œæ“ä½œï¼Œç­‰å…¨éƒ¨æ“ä½œå®Œæˆäº†ï¼Œå†æŠŠå®ƒæ¸²æŸ“æˆçœŸå®çš„DOMï¼Œé‚£å°±å˜æˆäº†çœŸå®çš„æ•°æ®ã€‚</p>
</li>
</ol>
<ul>
<li><strong>é‚£è¿™æ ·åšæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ</strong></li>
</ul>
<blockquote>
<p>å‡è®¾ç”¨æˆ·åªåšäº†å¾®å°çš„æ”¹åŠ¨ï¼Œæ¯”å¦‚å¢åŠ äº†2æ¡æ•°æ®ï¼Œé‚£æˆ‘ä»¬å¯ä»¥æƒ³æ‰“è¡¥ä¸ä¸€æ ·ï¼ŒåªæŠŠè¿™ä¸¤æ¡åŠ åˆ°çœŸå®çš„DOMé‡Œï¼Œè€Œä¸ç”¨æŠŠæ•´ä¸ªDOMé‡æ–°æ¸²æŸ“ã€‚</p>
</blockquote>
<p>é‚£è¿™æ˜¯è™šæ‹ŸDOMä»¥åŠä»–çš„ä½œç”¨</p>
<p><strong>é‚£è™šæ‹ŸDOMå°±æ˜¯é’ˆå¯¹çœŸå®DOMåšçš„ä¸€ä¸ªä¸€ä¸€æ˜ å°„çš„ç±»ä¼¼è™šæ‹Ÿçš„æ•°æ®ç»“æ„ï¼Œæœ‰äº†å˜åŒ–å†æŠŠæ•°æ®ç»“æ„æ¸²æŸ“åˆ°DOMé‡Œï¼Œåšåˆ°å±€éƒ¨çš„å˜åŒ–ï¼Œå®ç°è¡Œèƒ½ä¼˜åŒ–ã€‚</strong></p>
<h2 id="é‚£æˆ‘ä»¬æ€ä¹ˆå®ç°å®ƒå‘¢">é‚£æˆ‘ä»¬æ€ä¹ˆå®ç°å®ƒå‘¢</h2>
<ul>
<li>ä»¥ä¸‹ä»£ç ä¸ºå°†æ•°æ®ç»“æ„å¦‚ä½•è½¬åŒ–ä¸ºè™šæ‹ŸDOMï¼Œç„¶åå°†è™šæ‹ŸDOMæ¸²æŸ“åˆ°é¡µé¢ä¸­å˜æˆçœŸæ­£çš„DOMã€‚</li>
</ul>
<pre><code>
class VNode {
  constructor(tag, children, text) {
    this.tag = tag
    this.text = text
    this.children = children
  }

  render() {
    if(this.tag === '#text') {
      return document.createTextNode(this.text)
    }
    let el = document.createElement(this.tag)
    this.children.forEach(vChild =&gt; {
      el.appendChild(vChild.render())
    })
    return el
  }
}

function v(tag, children, text) {
  if(typeof children === 'string') {
    text = children
    children = []
  }
  return new VNode(tag, children, text)
}


/*
//è™šæ‹Ÿçš„JSONæ ¼å¼çš„æ•°æ®ç»“æ„
let nodesData = {
  tag: 'div',
  children: [
    {
      tag: 'p',
      children: [
        {
          tag: 'span',
          children: [
            {
              tag: '#text',
              text: 'hi'
            }
          ]
        }
      ]
    },
    {
      tag: 'span',
        children: [
          {
            tag: '#text',
            text: 'oo'
          }
        ]
    }
  ]
}

 */


let vNodes = v('div', [
      v('p', [
        v('span', [ v('#text', 'hi') ] )
        ]
      ),
      v('span', [
        v('#text',  'oo')
        ])
    ]
  )
console.log(vNodes.render())


</code></pre><h2 id="ä»€ä¹ˆæ˜¯diff">ä»€ä¹ˆæ˜¯diff</h2>
<p>æˆ‘ä»¬éœ€è¦åšä¸€äº›æ”¹å˜çš„æ—¶å€™ï¼Œæ¯”å¦‚å¢åˆ æ”¹æŸ¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å°†æ”¹å˜åçš„è™šæ‹ŸDOMæ ‘ä¸çœŸå®çš„DOMæ ‘åšå¯¹æ¯”ï¼Œæ‰¾å‡ºå·®å¼‚ï¼Œç„¶ååšåˆ°å±€éƒ¨æ›´æ–°æ”¹å˜çš„åœ°æ–¹ï¼Œé‚£ä¹ˆæ‰¾å‡ºå·®å¼‚å°±æ˜¯diffï¼ˆç®—æ³•æ‰¾ä¸¤æ£µDOMæ ‘çš„å·®å¼‚ï¼‰ã€‚</p>
<hr>
<p>ä»¥ä¸‹ä»£ç ä¸ºç®€å•çš„å®ç° DOM diff</p>
<pre><code>function patchElement(parent, newVNode, oldVNode, index = 0) {
  if(!oldVNode) {
    parent.appendChild(newVNode.render())
  } else if(!newVNode) {
    parent.removeChild(parent.childNodes[index])
  } else if(newVNode.tag !== oldVNode.tag || newVNode.text !== oldVNode.text) {
    parent.replaceChild(newVNode.render(), parent.childNodes[index])
  }  else {
    for(let i = 0; i &lt; newVNode.children.length || i &lt; oldVNode.children.length; i++) {
      patchElement(parent.childNodes[index], newVNode.children[i], oldVNode.children[i], i)
    }
  }
}



let vNode1 = v('div', [
      v('p', [
        v('span', [ v('#text', 'hi') ] )
        ]
      ),
      v('span', [
        v('#text',  'oo')
        ])
    ]
  )

let vNode2 = v('div', [
      v('p', [
        v('span', [ 
          v('#text', 'hi') 
          ] )
        ]
      ),
      v('span', [
        v('#text',  'oo'),
        v('#text',  'xx')
        ])
    ]
  )
const root = document.querySelector('#root')
patchElement(root, vNode1)
patchElement(root, vNode1ï¼ŒvNode2)

</code></pre>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/%E5%89%8D%E7%AB%AF/">å‰ç«¯</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>

    
</article>

     
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>


    

    <footer class="site-footer">
    <section class="copyright">&copy; 2020 808Mak1r</section>
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="1.0.5">Stack</a></b> designed by
        <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>

    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true" style="display:none">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

            </main>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"
    integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin="anonymous"></script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
<link rel="stylesheet" href="/css/highlight/light.min.css" media="(prefers-color-scheme: light)">
<link rel="stylesheet" href="/css/highlight/dark.min.css" media="(prefers-color-scheme: dark)">

    </body>
</html>
